import { Credentials } from '../libraries/Credentials';
import { QuestradeAPIOptions } from '../types';
import { apiGet } from './_apiGet';
import { oAuthLogic } from './_oAuthLogic';
/** As first test will get time from server after oAuthentiocation  */
export async function _getTimeFirst(
  options: QuestradeAPIOptions,
  cb: any = (creds: Credentials) => creds
) {
  const credentials = (await oAuthLogic(options)) as Credentials;
  try {
    const timeFirst = await _getTime(credentials);
    console.info('Server Time:', timeFirst);
  } catch (error) {
    console.log(error.message);
  }
  return cb(credentials);
}

export const _getTime = async (credentials: Credentials) => {
  try {
    const { time } = await apiGet('/time', credentials);
    return time;
  } catch (error) {
    throw new Error(error.message);
  }
};
